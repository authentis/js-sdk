"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@babel/runtime-corejs3/helpers/asyncToGenerator"),t=require("@babel/runtime-corejs3/regenerator"),a=require("@babel/runtime-corejs3/core-js/instance/index-of"),r=require("@babel/runtime-corejs3/core-js/url"),s=require("@babel/runtime-corejs3/core-js/instance/map"),i=require("@babel/runtime-corejs3/core-js/object/keys"),n=require("@babel/runtime-corejs3/core-js/json/stringify"),c=require("@babel/runtime-corejs3/core-js/object/assign");function o(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var h=o(e),u=o(t),l=o(a),p=o(r),d=o(s),f=o(i),m=o(n),g=o(c);function j(){return{handshake:this.createRequest.call(this,{method:"PUT",path:"/captcha"}),verify:this.createRequest.call(this,{method:"POST",path:"/captcha"})}}function R(){return{state:this.createRequest.call(this,{method:"GET",path:"/auth/state"}),session:this.createRequest.call(this,{method:"POST",path:"/auth/session"}),epwd:this.createRequest.call(this,{method:"POST",path:"/auth/signin/epwd"}),epwdv:this.createRequest.call(this,{method:"PUT",path:"/auth/signin/epwd"}),eotp:this.createRequest.call(this,{method:"POST",path:"/auth/signin/eotp"}),eotpv:this.createRequest.call(this,{method:"PUT",path:"/auth/signin/eotp"}),potp:this.createRequest.call(this,{method:"POST",path:"/auth/signin/potp"}),potpv:this.createRequest.call(this,{method:"PUT",path:"/auth/signin/potp"}),revoke:this.createRequest.call(this,{method:"DELETE",path:"/auth/revoke"})}}function b(){return{create:this.createRequest.call(this,{method:"POST",path:"/org"}),update:this.createRequest.call(this,{method:"PUT",path:"/org"}),get:this.createRequest.call(this,{method:"GET",path:"/org"}),remove:this.createRequest.call(this,{method:"DELETE",path:"/org"})}}function q(){return{create:this.createRequest.call(this,{method:"POST",path:"/project"}),update:this.createRequest.call(this,{method:"PUT",path:"/project"}),get:this.createRequest.call(this,{method:"GET",path:"/project"}),remove:this.createRequest.call(this,{method:"DELETE",path:"/project"}),signinMethod:{create:this.createRequest.call(this,{method:"POST",path:"/project/signin-method"}),update:this.createRequest.call(this,{method:"PUT",path:"/project/signin-method"}),get:this.createRequest.call(this,{method:"GET",path:"/project/signin-method"}),remove:this.createRequest.call(this,{method:"DELETE",path:"/project/signin-method"})}}}function T(){return{create:this.createRequest.call(this,{method:"POST",path:"/app"}),update:this.createRequest.call(this,{method:"PUT",path:"/app"}),get:this.createRequest.call(this,{method:"GET",path:"/app"}),remove:this.createRequest.call(this,{method:"DELETE",path:"/app"})}}function P(){return{inspect:this.createRequest.call(this,{method:"PUT",path:"/device"})}}function v(){return{signinMethod:this.createRequest.call(this,{method:"GET",path:"/subject/signin-method"})}}function E(){return function(e){this.config=g.default({},this.config,e)}.bind(this)}function y(){return function(){return this.config}.bind(this)}function S(e){if(this.config={host:e.host,version:e.version||null,projectIdentifier:e.projectIdentifier||"",projectLocale:e.locale||"",token:e.token||null,clientId:e.clientId||null,clientSecret:e.clientSecret||null},!this.config.host)throw new Error('Missing option "host".');return this.setLastResponse=function(e){this.lastResponse=e},this.getLastResponse=function(){return this.lastResponse},this.createAuthHeader=function(e){return e.token?"Bearer "+e.token:e.clientId&&e.clientSecret?"Basic "+btoa(e.clientId+":"+e.clientSecret):""},this.createHeaders=function(e){var t;return g.default({},{Accept:"application/json","Cache-Control":"no-cache",Pragma:"no-cache"},-1!==l.default(t=["POST","PUT"]).call(t,e.method)?{"Content-Type":"application/json"}:{},{Authorization:this.createAuthHeader(this.config)},this.config.projectIdentifier?{"Authentis-Project-Identifier":this.config.projectIdentifier}:{},this.config.projectLocale?{"Authentis-Project-Locale":this.config.projectLocale}:{})},{configure:E.apply(this),getConfig:y.apply(this),getLastResponse:this.getLastResponse.bind(this),captcha:j.apply(this),auth:R.apply(this),organization:b.apply(this),project:q.apply(this),app:T.apply(this),device:P.apply(this),subject:v.apply(this)}}function O(e){var t,a=this;l.default(t=["POST","PUT"]).call(t,e.method);var r={method:e.method,credentials:"same-origin",mode:"cors",headers:a.createHeaders.call(a,e)};return function(){var t=h.default(u.default.mark((function t(){var s,i,n,c,o,h=arguments;return u.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s=h.length>0&&void 0!==h[0]?h[0]:{},i=new p.default(e.path,a.config.host),s.path&&Array.isArray(s.path)&&(i.pathname+="/"+s.path.join("/")),s.searchParams&&d.default(n=f.default(s.searchParams)).call(n,(function(e){return i.searchParams.set(e,s.searchParams[e])})),!s.id){t.next=8;break}if(!/[^a-zA-Z0-9-]+/.test(s.id)){t.next=7;break}return t.abrupt("return",{error:{code:"REQUEST_ERROR",details:"Invalid identifier."}});case 7:i.pathname=e.path+"/"+s.id;case 8:return s.body&&("[object Object]"===Object.prototype.toString.call(s.body)?r.body=m.default(s.body):r.body=s.body),t.prev=9,t.next=12,fetch(i,r);case 12:return c=t.sent,a.setLastResponse.call(a,c),t.next=16,c.json();case 16:return o=t.sent,t.abrupt("return",o);case 20:return t.prev=20,t.t0=t.catch(9),t.abrupt("return",{error:{code:"REQUEST_ERROR"}});case 23:case"end":return t.stop()}}),t,null,[[9,20]])})));return function(){return t.apply(this,arguments)}}()}exports.configure=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return S.call({createRequest:O},e)},exports.createRequest=O;
//# sourceMappingURL=index.js.map
