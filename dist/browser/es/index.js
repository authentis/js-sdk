import t from"@babel/runtime-corejs3/helpers/asyncToGenerator";import e from"@babel/runtime-corejs3/regenerator";import r from"@babel/runtime-corejs3/core-js/instance/index-of";import a from"@babel/runtime-corejs3/core-js/url";import i from"@babel/runtime-corejs3/core-js/instance/map";import s from"@babel/runtime-corejs3/core-js/object/keys";import o from"@babel/runtime-corejs3/core-js/json/stringify";import n from"@babel/runtime-corejs3/core-js/object/assign";function c(){return{handshake:this.createRequest.call(this,{method:"PUT",path:"/captcha"}),verify:this.createRequest.call(this,{method:"POST",path:"/captcha"})}}function h(){return{state:this.createRequest.call(this,{method:"GET",path:"/auth/state"}),session:this.createRequest.call(this,{method:"POST",path:"/auth/session"}),epwd:this.createRequest.call(this,{method:"POST",path:"/auth/signin/epwd"}),epwdv:this.createRequest.call(this,{method:"PUT",path:"/auth/signin/epwd"}),eotp:this.createRequest.call(this,{method:"POST",path:"/auth/signin/eotp"}),eotpv:this.createRequest.call(this,{method:"PUT",path:"/auth/signin/eotp"}),potp:this.createRequest.call(this,{method:"POST",path:"/auth/signin/potp"}),potpv:this.createRequest.call(this,{method:"PUT",path:"/auth/signin/potp"}),revoke:this.createRequest.call(this,{method:"DELETE",path:"/auth/revoke"})}}function p(){return{create:this.createRequest.call(this,{method:"POST",path:"/org"}),update:this.createRequest.call(this,{method:"PUT",path:"/org"}),get:this.createRequest.call(this,{method:"GET",path:"/org"}),remove:this.createRequest.call(this,{method:"DELETE",path:"/org"})}}function l(){return{create:this.createRequest.call(this,{method:"POST",path:"/project"}),update:this.createRequest.call(this,{method:"PUT",path:"/project"}),get:this.createRequest.call(this,{method:"GET",path:"/project"}),remove:this.createRequest.call(this,{method:"DELETE",path:"/project"}),signinMethod:{create:this.createRequest.call(this,{method:"POST",path:"/project/signin-method"}),update:this.createRequest.call(this,{method:"PUT",path:"/project/signin-method"}),get:this.createRequest.call(this,{method:"GET",path:"/project/signin-method"}),remove:this.createRequest.call(this,{method:"DELETE",path:"/project/signin-method"})}}}function u(){return{create:this.createRequest.call(this,{method:"POST",path:"/app"}),update:this.createRequest.call(this,{method:"PUT",path:"/app"}),get:this.createRequest.call(this,{method:"GET",path:"/app"}),remove:this.createRequest.call(this,{method:"DELETE",path:"/app"})}}function d(){return{inspect:this.createRequest.call(this,{method:"PUT",path:"/device"})}}function m(){return{signinMethod:this.createRequest.call(this,{method:"GET",path:"/subject/signin-method"})}}function f(){return function(t){this.config=n({},this.config,t)}.bind(this)}function g(){return function(){return this.config}.bind(this)}function R(t){if(this.config={host:t.host,version:t.version||null,projectIdentifier:t.projectIdentifier||"",projectLocale:t.locale||"",token:t.token||null,clientId:t.clientId||null,clientSecret:t.clientSecret||null},!this.config.host)throw new Error('Missing option "host".');return this.setLastResponse=function(t){this.lastResponse=t},this.getLastResponse=function(){return this.lastResponse},this.createAuthHeader=function(t){return t.token?"Bearer "+t.token:t.clientId&&t.clientSecret?"Basic "+btoa(t.clientId+":"+t.clientSecret):""},this.createHeaders=function(t){var e;return n({},{Accept:"application/json","Cache-Control":"no-cache",Pragma:"no-cache"},-1!==r(e=["POST","PUT"]).call(e,t.method)?{"Content-Type":"application/json"}:{},{Authorization:this.createAuthHeader(this.config)},this.config.projectIdentifier?{"Authentis-Project-Identifier":this.config.projectIdentifier}:{},this.config.projectLocale?{"Authentis-Project-Locale":this.config.projectLocale}:{})},{configure:f.apply(this),getConfig:g.apply(this),getLastResponse:this.getLastResponse.bind(this),captcha:c.apply(this),auth:h.apply(this),organization:p.apply(this),project:l.apply(this),app:u.apply(this),device:d.apply(this),subject:m.apply(this)}}function j(n){var c,h=this;r(c=["POST","PUT"]).call(c,n.method);var p={method:n.method,credentials:"same-origin",mode:"cors",headers:h.createHeaders.call(h,n)};return function(){var r=t(e.mark((function t(){var r,c,l,u,d,m=arguments;return e.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=m.length>0&&void 0!==m[0]?m[0]:{},c=new a(n.path,h.config.host),r.path&&Array.isArray(r.path)&&(c.pathname+="/"+r.path.join("/")),r.searchParams&&i(l=s(r.searchParams)).call(l,(function(t){return c.searchParams.set(t,r.searchParams[t])})),!r.id){t.next=8;break}if(!/[^a-zA-Z0-9-]+/.test(r.id)){t.next=7;break}return t.abrupt("return",{error:{code:"REQUEST_ERROR",details:"Invalid identifier."}});case 7:c.pathname=n.path+"/"+r.id;case 8:return r.body&&("[object Object]"===Object.prototype.toString.call(r.body)?p.body=o(r.body):p.body=r.body),t.prev=9,t.next=12,fetch(c,p);case 12:return u=t.sent,h.setLastResponse.call(h,u),t.next=16,u.json();case 16:return d=t.sent,t.abrupt("return",d);case 20:return t.prev=20,t.t0=t.catch(9),t.abrupt("return",{error:{code:"REQUEST_ERROR"}});case 23:case"end":return t.stop()}}),t,null,[[9,20]])})));return function(){return r.apply(this,arguments)}}()}function b(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return R.call({createRequest:j},t)}export{b as configure,j as createRequest};
//# sourceMappingURL=index.js.map
